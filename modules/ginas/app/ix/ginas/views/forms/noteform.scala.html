@import ix.ginas.controllers.GinasApp

<div class = "row info" >
    <button class="btn btn-primary label-offset det">
                        Notes&nbsp;<span class="badge" ng-show="substance.notes.length>0">
                        {{substance.notes.length}}</span> </button>
    <a ng-show="!addingNotes" ng-click="addNotes()" aria-label="Add Notes"><i class = "fa fa-plus fa-2x success"></i></a>
    <a ng-show="addingNotes" ng-click="addNotes()" aria-label="Done"><i class = "fa fa-minus fa-2x danger"></i></a>
    <div class="col-md-12">
        <div class = "row header-row">
            <div class = "col-md-9">
                <strong>Note</strong>
            </div>
            <div class = "col-md-2 text-right" >
                <strong>Reference ID</strong>
            </div>
        </div>

        <div class = "row" ng-repeat="obj in substance.notes">
            <div class = "col-md-9">
                    <span href="#" editable-textarea="obj.note" blur="submit">{{obj.note}}</span>
            </div>
                <div class = "col-md-2"><span ng-repeat="n in onj.references">
                    <span ng-show="!note.references || note.references.length==0" ng-click="toggle(noteForm.references)" ><i class="fa fa-plus fa-2x success"></i></span>
                    <span ng-show="!noteForm.references.selected" ng-click="toggle(noteForm.references)" >{{n.id}} {{n.citation}}</span>
                </span>
                    <tags-input ng-show ="noteForm.references.selected" ng-blur="toggle(noteForm.references)" custom-class="form-control" title="References" placeholder="References" id="references" name="references" ng-model = "note.references" display-property="citation" key-property="id" addFromAutocompleteOnly="true" >
                        <auto-complete source="substance.references" min-length="1" debounce-delay="0" load-on-down-arrow="true"></auto-complete>
                    </tags-input>
                </div>
                    {{obj.references.id}} {{obj.references.citation}}
            </div>

        <form class="form-horizontal" name="noteForm" id = "add-note" role="form" novalidate>
        <div class="row form-row" >
                <div class="col-md-9 err-check" id="note-div" show-errors>
                    <textarea type="text" class="form-control" ng-model ="note.note" title="Note" id="note" name = "note" required></textarea>
                </div>
                @referenceselectorform("noteForm", "note")
        </div>
        @submitbuttons("note", "noteForm", "notes")
        </form>
    </div>
</div>

